<?php //computer_info.php
class Computer_Info
{
    // get the connections in here
    private $conn;
    private $table_name = "computer_information";
    
    // object properties
    public $business_id;
    public $machine_id;
    public $os;
    public $os_sn;
    public $user;
    public $uptime;
    public $manufacturer;
    public $model;
    public $serial_number;
    public $firewall;
    public $drive_size;
    public $drive_free_space;
    public $ram;
    public $processor;
    public $cd_drive;
    public $graphics;
    
    // constructor using db connection
    public function __construct($db)
    {
        $this->conn         = $db;
    }
    
    // read computers
    function read()
    {
        $this->business_id  = htmlspecialchars(strip_tags($this->business_id));
        
        // select all query
        $query  = "SELECT
                        Business_ID,
                        Machine_ID,
                        Operating_System,
                        OS_Serial_Number,
                        User_Current,
                        System_Uptime,
                        System_Manufacturer,
                        System_Model,
                        Serial_Number,
                        Firewall_Active,
                        Drive_Size,
                        Drive_Free_Space,
                        RAM,
                        Processor,
                        CD_Drive,
                        Graphics_Card
                    FROM ". $this->table_name ."
                    WHERE Business_ID = '". $this->business_id ."'
                    ORDER BY Machine_ID";
        
        // prepare query statement
        $stmt   = $this->conn->prepare($query);

        // execute query
        $stmt->execute();
        
        return $stmt;
    }
    
    // pull one
    function pull_one()
    {
        // select all query
        $query  = "SELECT
                        Operating_System,
                        OS_Serial_Number,
                        User_Current,
                        System_Uptime,
                        System_Manufacturer,
                        System_Model,
                        Serial_Number,
                        Firewall_Active,
                        Drive_Size,
                        Drive_Free_Space,
                        RAM,
                        Processor,
                        CD_Drive,
                        Graphics_Card
                    FROM ". $this->table_name ."
                    WHERE Business_ID = '". $business_id ."' AND Machine_ID = '". $machine_id ."'
                    ORDER BY Business_ID,Machine_ID";
        
        // prepare query statement
        $stmt   = $this->conn->prepare($query);

        // execute query
        $stmt->execute();
        
        $row = $stmt->fetch(PDO::FETCH_ASSOC);
        // Set the values for this class from the data
        $this->os               = $row['Operating_System'];
        $this->os_sn            = $row['OS_Serial_Number'];
        $this->user             = $row['User_Current'];
        $this->uptime           = $row['System_Uptime'];
        $this->manufacturer     = $row['System_Manufacturer'];
        $this->model            = $row['System_Model'];
        $this->serial_number    = $row['Serial_Number'];
        $this->firewall         = $row['Firewall_Active'];
        $this->drive_size       = $row['Drive_Size'];
        $this->drive_free_space = $row['Drive_Free_Space'];
        $this->ram              = $row['RAM'];
        $this->processor        = $row['Processor'];
        $this->cd_drive         = $row['CD_Drive'];
        $this->graphics         = $row['Graphics_Card'];
    }
    
    // creating one might be handy
    function create()
    {
        $query  = "INSERT INTO ". $this->table_name ."
                    (
                        Business_ID,
                        Machine_ID,
                        Operating_System,
                        OS_Serial_Number,
                        User_Current,
                        System_Uptime,
                        System_Manufacturer,
                        System_Model,
                        Serial_Number,
                        Firewall_Active,
                        Drive_Size,
                        Drive_Free_Space,
                        RAM,
                        Processor,
                        CD_Drive,
                        Graphics_Card
                    )
                    VALUES
                    (
                        :business_id,
                        :machine_id,
                        :os,
                        :os_sn,
                        :user,
                        :uptime,
                        :manufacturer,
                        :model,
                        :serial_number,
                        :firewall,
                        :drive_size,
                        :drive_free_space,
                        :ram,
                        :processor,
                        :cd_drive,
                        :graphics
                    )";
        // prepare the statement
        $stmt = $this->conn->prepare($query);
        
        // sanitize
        $this->business_id      = htmlspecialchars(strip_tags($this->business_id));
        $this->machine_id       = htmlspecialchars(strip_tags($this->machine_id));
        $this->os               = htmlspecialchars(strip_tags($this->os));
        $this->os_sn            = htmlspecialchars(strip_tags($this->os_sn));
        $this->user             = htmlspecialchars(strip_tags($this->user));
        $this->uptime           = htmlspecialchars(strip_tags($this->uptime));
        $this->manufacturer     = htmlspecialchars(strip_tags($this->manufacturer));
        $this->model            = htmlspecialchars(strip_tags($this->model));
        $this->serial_number    = htmlspecialchars(strip_tags($this->serial_number));
        $this->firewall         = htmlspecialchars(strip_tags($this->firewall));
        $this->drive_size       = htmlspecialchars(strip_tags($this->drive_size));
        $this->drive_free_space = htmlspecialchars(strip_tags($this->drive_free_space));
        $this->ram              = htmlspecialchars(strip_tags($this->ram));
        $this->processor        = htmlspecialchars(strip_tags($this->processor));
        $this->cd_drive         = htmlspecialchars(strip_tags($this->cd_drive));
        $this->graphics         = htmlspecialchars(strip_tags($this->graphics));
        
        // and in the darkness? You know what to do
        $stmt->bindParam(':business_id',        $this->business_id);
        $stmt->bindParam(':machine_id',         $this->machine_id);
        $stmt->bindParam(':os',                 $this->os);
        $stmt->bindParam(':os_sn',              $this->os_sn);
        $stmt->bindParam(':user',               $this->user);
        $stmt->bindParam(':uptime',             $this->uptime);
        $stmt->bindParam(':manufacturer',       $this->manufacturer);
        $stmt->bindParam(':model',              $this->model);
        $stmt->bindParam(':serial_number',      $this->serial_number);
        $stmt->bindParam(':firewall',           $this->firewall);
        $stmt->bindParam(':drive_size',         $this->drive_size);
        $stmt->bindParam(':drive_free_space',   $this->drive_free_space);
        $stmt->bindParam(':ram',                $this->ram);
        $stmt->bindParam(':processor',          $this->processor);
        $stmt->bindParam(':cd_drive',           $this->cd_drive);
        $stmt->bindParam(':graphics',           $this->graphics);
        
        // execute that bad girl
        if ($stmt->execute())
        {
            return true;
        }
        //mysqli_report(MYSQLI_REPORT_ERROR | MYSQLI_REPORT_STRICT);
        return false;
    }

    // update
    function update()
    {
        // the update query
        $query  = "UPDATE ". $this->table_name ."
                    SET
                        Operating_System    =:os,
                        OS_Serial_Number    =:os_sn,
                        User_Current        =:user,
                        System_Uptime       =:uptime,
                        System_Manufacturer =:manufacturer,
                        System_Model        =:model,
                        Serial_Number       =:serial_number,
                        Firewall_Active     =:firewall,
                        Drive_Size          =:drive_size,
                        Drive_Free_Space    =:drive_free_space,
                        RAM                 =:ram,
                        Processor           =:processor,
                        CD_Drive            =:cd_drive,
                        Graphics_Card       =:graphics
                    WHERE
                        Business_ID         =:business_id
                            AND
                        Machine_ID          =:machine_id";

        // prepare the statement
        $stmt   = $this->conn->prepare($query);
        
        // sanitize that shiiiiiz
        $this->business_id      = htmlspecialchars(strip_tags($this->business_id));
        $this->machine_id       = htmlspecialchars(strip_tags($this->machine_id));
        $this->os               = htmlspecialchars(strip_tags($this->os));
        $this->os_sn            = htmlspecialchars(strip_tags($this->os_sn));
        $this->user             = htmlspecialchars(strip_tags($this->user));
        $this->uptime           = htmlspecialchars(strip_tags($this->uptime));
        $this->manufacturer     = htmlspecialchars(strip_tags($this->manufacturer));
        $this->model            = htmlspecialchars(strip_tags($this->model));
        $this->serial_number    = htmlspecialchars(strip_tags($this->serial_number));
        $this->firewall         = htmlspecialchars(strip_tags($this->firewall));
        $this->drive_size       = htmlspecialchars(strip_tags($this->drive_size));
        $this->drive_free_space = htmlspecialchars(strip_tags($this->drive_free_space));
        $this->ram              = htmlspecialchars(strip_tags($this->ram));
        $this->processor        = htmlspecialchars(strip_tags($this->processor));
        $this->cd_drive         = htmlspecialchars(strip_tags($this->cd_drive));
        $this->graphics         = htmlspecialchars(strip_tags($this->cd_drive));
        $this->business_id      = htmlspecialchars(strip_tags($this->business_id));
        $this->machine_id       = htmlspecialchars(strip_tags($this->machine_id));
        
        // and in the darkness? You know what to do
        $stmt->bindParam(':business_id',        $this->business_id);
        $stmt->bindParam(':machine_id',         $this->machine_id);
        $stmt->bindParam(':os',                 $this->os);
        $stmt->bindParam(':os_sn',              $this->os_sn);
        $stmt->bindParam(':user',               $this->user);
        $stmt->bindParam(':uptime',             $this->uptime);
        $stmt->bindParam(':manufacturer',       $this->manufacturer);
        $stmt->bindParam(':model',              $this->model);
        $stmt->bindParam(':serial_number',      $this->serial_number);
        $stmt->bindParam(':firewall',           $this->firewall);
        $stmt->bindParam(':drive_size',         $this->drive_size);
        $stmt->bindParam(':drive_free_space',   $this->drive_free_space);
        $stmt->bindParam(':ram',                $this->ram);
        $stmt->bindParam(':processor',          $this->processor);
        $stmt->bindParam(':cd_drive',           $this->cd_drive);
        $stmt->bindParam(':graphics',           $this->graphics);
        $stmt->bindParam(':business_id',        $this->business_id);
        $stmt->bindParam(':machine_id',         $this->machine_id);
        
        // execute that bad girl
        if ($stmt->execute())
        {
            return true;
        }
        return false;
    }
}
?>