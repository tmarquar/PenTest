<?php // network_information.php
class Network
{
    // set up connections
    private $conn;
    private $table_name = "network_information";
    
    // object properties
    public $business_id;
    public $machine_id;
    public $description;
    public $dns_hostname;
    public $ip_address;
    public $mac_address;
    
    public function __construct($db)
    {
        $this->conn         = $db;
    }
    
    // read all network information
    function read()
    {
        $this->business_id      = htmlspecialchars(strip_tags($this->business_id));
        
        $query  = "SELECT Description, DNS_Hostname, IP_Address, MAC_Address
                    FROM ". $this->table_name ."
                    WHERE
                        Business_ID = '". $this->business_id ."'";
        
        // prepare it
        $stmt   = $this->conn->prepare($query);
        
        $stmt->execute();
        
        return $stmt;
    }
    
    // pull a 'network_info'
    function read_one()
    {
        $query  = "SELECT Description, DNS_Hostname, IP_Address, MAC_Address
                    FROM ". $this->table_name ."
                    WHERE
                        Business_ID = '". $this->business_id ."'
                            AND
                        Machine_ID = '". $this->machine_id ."'";
        
        // prepare it
        $stmt   = $this->conn->prepare($query);
        
        $stmt->execute();
        
        $row    = $stmt->fetch(PDO::FETCH_ASSOC);
        // set the variables
        $this->description  = $row['Description'];
        $this->dns_hostname = $row['DNS_Hostname'];
        $this->ip_address   = $row['IP_Address'];
        $this->mac_address  = $row['MAC_Address'];
    }
    
    function create()
    {
        $query  = "INSERT INTO ". $this->table_name ."
                    SET
                        Business_ID     =:business_id,
                        Machine_ID      =:machine_id,
                        Description     =:description,
                        DNS_Hostname    =:dns_hostname,
                        IP_Address      =:ip_address,
                        Mac_Address     =:mac_address";
        
        $stmt   = $this->conn->prepare($query);
        
        $this->business_id  = htmlspecialchars(strip_tags($this->business_id));
        $this->machine_id   = htmlspecialchars(strip_tags($this->machine_id));
        $this->description  = htmlspecialchars(strip_tags($this->description));
        $this->dns_hostname = htmlspecialchars(strip_tags($this->dns_hostname));
        $this->ip_address   = htmlspecialchars(strip_tags($this->ip_address));
        $this->mac_address  = htmlspecialchars(strip_tags($this->mac_address));
        
        $stmt->bindParam(':business_id',    $this->business_id);
        $stmt->bindParam(':machine_id',     $this->machine_id);
        $stmt->bindParam(':description',    $this->description);
        $stmt->bindParam(':dns_hostname',   $this->dns_hostname);
        $stmt->bindParam(':ip_address',     $this->ip_address);
        $stmt->bindParam(':mac_address',    $this->mac_address);
        
        if ($stmt->execute())
        {
            return true;
        }
        return false;
    }
    
    function update()
    {
        // the update query
        $query  = "UPDATE ". $this->table_name ."
                    SET
                        Description     =:description,
                        DNS_Hostname    =:dns_hostname,
                        IP_Address      =:ip_address,
                        Mac_Address     =:mac_address";
        
        $stmt   = $this->conn->prepare($query);
        
        $this->description  = htmlspecialchars(strip_tags($this->description));
        $this->dns_hostname = htmlspecialchars(strip_tags($this->dns_hostname));
        $this->ip_address   = htmlspecialchars(strip_tags($this->ip_address));
        $this->mac_address  = htmlspecialchars(strip_tags($this->mac_address));
        
        $stmt->bindParam(':description',    $this->description);
        $stmt->bindParam(':dns_hostname',   $this->dns_hostname);
        $stmt->bindParam(':ip_address',     $this->ip_address);
        $stmt->bindParam(':mac_address',    $this->mac_address);
        
        if ($stmt->execute())
        {
            return true;
        }
        return false;
    }
}
?>