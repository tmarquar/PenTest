#Script for Senior Design
#Used for collecting info from target computers fast. 
#Creates 3 files with the service, process, and childitem info.

$date1 = (get-date -Format FileDate) + "ser"
$date2 = (get-date -Format FileDate) + "pro"
$date3 = (get-date -Format FileDate) + "chi"
$doc_path = "This PC\Documents" #Not Working
$des_path = "This PC\Desktop"   #Not Working
$usr_path = "C:\"

get-service | out-file "$date1.log"
get-process | out-file "$date2.log"
get-childitem -File -Attributes !Directory+!System -Recurse -Name -Include *.txt, *.doc, *.docx -Path $usr_path | out-file "$date3.log"
#Need to get the paths working to do this test but the TestPath does work. 
<#
if(Test-Path -Path $doc_path){
	get-childitem -File -Attributes !Directory+!System -Recurse -Name -Path $doc_path | out-file -Append "$date3.log" 
	}
	
if(Test-Path -Path $des_path){
	get-childitem -File -Attributes !Directory+!System -Recurse -Name -Path $des_path | out-file -Append "$date3.log" 
	}
	
if(Test-Path -Path $usr_path){
	get-childitem -File -Attributes !Directory+!System -Recurse -Name -Include *.txt, *.doc, *.docx -Path $usr_path | out-file -Append "$date3.log" 
	}
	#>
	